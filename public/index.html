<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Enter | Vinayak Mishra</title>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">

    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:Inter,system-ui;height:100vh;overflow:hidden;color:white;}
        .background{position:fixed;inset:0;background:linear-gradient(120deg,#6a00ff,#b517ff,#00d4ff,#6a00ff);background-size:400% 400%;animation:gradientMove 10s ease infinite;z-index:-2;}
        @keyframes gradientMove{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
        .glow{position:fixed;inset:0;background:radial-gradient(circle at center,rgba(255,255,255,0.15),transparent 60%);z-index:-1;}
        .container{height:100%;display:flex;align-items:center;justify-content:center;padding:20px;}
        .card{background:rgba(0,0,0,0.35);backdrop-filter:blur(20px);border-radius:28px;padding:50px 40px;max-width:420px;width:100%;text-align:center;box-shadow:0 30px 80px rgba(0,0,0,0.4);animation:fadeUp 1.2s ease;}
        @keyframes fadeUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
        .card h1{font-size:2.4rem;font-weight:800;background:linear-gradient(90deg,#ffd6ff,#cdb4ff,#9bf6ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
        .card p{margin-top:12px;opacity:.85;}
        .card input{margin-top:30px;width:100%;padding:15px;border-radius:14px;border:none;outline:none;font-size:16px;}
        .card button{margin-top:20px;width:100%;padding:15px;border-radius:14px;border:none;font-size:16px;font-weight:700;cursor:pointer;color:#000;background:linear-gradient(90deg,#ffb3ff,#a5f3fc);}
    </style>
</head>
<body>

<div class="background"></div>
<div class="glow"></div>

<div class="container">
    <div class="card">
        <h1>Welcome</h1>
        <p>Enter your name to continue</p>

        <input id="username" placeholder="Your name" autocomplete="off" />
        <button onclick="next()">Next</button>
    </div>
</div>

<!-- Firebase v10+ Modular SDK – Fixed version -->
<script type="module">
    // Firebase imports
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    const firebaseConfig = {
        apiKey:            "AIzaSyChFehhMdGREwt7-iV30FtuYfSMTp5A9xw",
        authDomain:        "replyisnmtant.firebaseapp.com",
        projectId:         "replyisnmtant",
        storageBucket:     "replyisnmtant.firebasestorage.app",
        messagingSenderId: "196562164334",
        appId:             "1:196562164334:web:a3b4975f6b76291a65647f"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Fixed & safe version – no undefined values
    window.next = async function() {
        const name = document.getElementById("username").value.trim();

        if (!name) {
            alert("Please enter your name");
            return;
        }

        const visitorData = {
            name: name,
            timestamp: new Date().toISOString(),
            localTime: new Date().toLocaleString('en-IN', { timeZoneName: 'short' }),
            timeZone: Intl.DateTimeFormat().resolvedOptions().timeZone || "Unknown",

            // Browser basics
            userAgent: navigator.userAgent?.substring(0, 180) || "Unknown",
            platform: navigator.platform || "Unknown",
            language: navigator.language || "Unknown",
            languages: Array.isArray(navigator.languages) 
                ? navigator.languages.join(", ") 
                : (navigator.language || "Unknown"),

            // Screen information (very useful)
            screenResolution: `${screen.width}×${screen.height}`,
            availResolution: `${screen.availWidth}×${screen.availHeight}`,
            colorDepth: screen.colorDepth || "Unknown",
            pixelRatio: window.devicePixelRatio || 1,

            // Hardware
            hardwareCores: navigator.hardwareConcurrency || "?",
            deviceMemoryGB: navigator.deviceMemory || "?",
            maxTouchPoints: navigator.maxTouchPoints ?? 0,

            // Network (mobile-friendly)
            connectionType: navigator.connection?.effectiveType || "unknown",
            downlinkMbps: navigator.connection?.downlink ?? "?",
            rtt: navigator.connection?.rtt ?? "?",

            // Context
            referrer: document.referrer || null,
            pageUrl: window.location.href
        };

        try {
            await addDoc(collection(db, "site_entries"), visitorData);
            // Success → redirect
            window.location.href = "portfolio.html";  // ← change to "portfolio.html" if needed
        } catch (error) {
            console.error("Firebase error:", error);
            alert("Something went wrong. Check console (F12) → " + error.message);
        }
    };
</script>

</body>
</html>
